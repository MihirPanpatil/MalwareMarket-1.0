from django.db import models

class IPFSFile(models.Model):
    file_name = models.CharField(max_length=255)
    ipfs_hash = models.CharField(max_length=255)
    solana_transaction = models.CharField(max_length=255, null=True, blank=True)
    domain_name = models.CharField(max_length=255, null=True, blank=True)
    uploaded_at = models.DateTimeField(auto_now_add=True)
    
    @property
    def ipfs_url(self):
        return f"https://ipfs.io/ipfs/{self.ipfs_hash}"
    
    @property
    def onion_url(self):
        with open('hidden_service/hostname', 'r') as f:
            onion_domain = f.read().strip()
        return f"http://{onion_domain}"

    def __str__(self):
        return f"{self.file_name} - {self.ipfs_hash}"
